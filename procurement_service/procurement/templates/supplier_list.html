{% load static %}
<!DOCTYPE html>
<html lang="ru">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>–°–ø–∏—Å–æ–∫ –ø–æ—Å—Ç–∞–≤—â–∏–∫–æ–≤</title>
  <link rel="stylesheet" href="{% static 'css/bootstrap.min.css' %}">
  <link rel="stylesheet" href="{% static 'font/bootstrap-icons.css' %}">
  <style>
    html,
    body {
      height: 100%;
      margin: 0;
      padding: 0;
      background: linear-gradient(135deg, #dbeafe, #93c5fd);
      background-attachment: fixed;
    }

    h1 {
      color: #007bff;
      font-weight: bold;
    }

    thead th {
      background-color: #007bff !important;
      color: white !important;
      text-align: center;
      border: 2px solid #0056b3 !important;
      text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.2);
      padding: 12px;
    }

    .btn-sm {
      font-size: 14px;
      padding: 6px 10px;
    }

    /* –û—Ç—Å—Ç—É–ø –¥–ª—è —Å–æ–¥–µ—Ä–∂–∏–º–æ–≥–æ, —á—Ç–æ–±—ã –æ–Ω–æ –Ω–µ –ø–µ—Ä–µ–∫—Ä—ã–≤–∞–ª–æ—Å—å –Ω–∞–≤–∏–≥–∞—Ü–∏–æ–Ω–Ω–æ–π –ø–∞–Ω–µ–ª—å—é */
    .content {
      padding-top: 80px;
      /* –£–≤–µ–ª–∏—á—å—Ç–µ —ç—Ç–æ –∑–Ω–∞—á–µ–Ω–∏–µ, –µ—Å–ª–∏ –ø–∞–Ω–µ–ª—å –≤—ã—à–µ */
    }
  </style>
</head>

<body class="d-flex flex-column" style="height: 100vh;">

  {% include 'header.html' %}

  <div class="container flex-grow-1 content">
    <div class="d-flex justify-content-between align-items-center mb-3">
      <h1>–°–ø–∏—Å–æ–∫ –ø–æ—Å—Ç–∞–≤—â–∏–∫–æ–≤</h1>
      <a href="{% url 'add_supplier' %}" class="btn btn-success fw-semibold">+ –î–æ–±–∞–≤–∏—Ç—å –ø–æ—Å—Ç–∞–≤—â–∏–∫–∞</a>
    </div>

    <div class="table-responsive">
      <table class="table table-hover table-bordered table-striped align-middle">
        <thead>
          <tr class="text-center">
            <th>–ò–º—è</th>
            <th>–ö–æ–Ω—Ç–∞–∫—Ç–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è</th>
            <th>–î–µ–π—Å—Ç–≤–∏—è</th>
          </tr>
        </thead>
        <tbody>
          {% for supplier in suppliers %}
          <tr>
            <td>{{ supplier.name }}</td>
            <td>{{ supplier.contact_info }}</td>
            <td class="text-center">
              <a href="{% url 'edit_supplier' supplier.id %}" class="btn btn-warning btn-sm">‚úèÔ∏è –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å</a>
              <a href="{% url 'delete_supplier' supplier.id %}" class="btn btn-danger btn-sm">üóë –£–¥–∞–ª–∏—Ç—å</a>
              <!-- –°—Ç–∞—Ä—ã–π –≤–∞—Ä–∏–Ω—Ç –±–µ–∑ —Ç–æ–∫–∏–Ω–æ–≤ -->
              <!-- <a href="{% url 'supplier_form' supplier.id %}" class="btn btn-primary btn-sm">üìã –î–ª—è –ø–æ—Å—Ç–∞–≤—â–∏–∫–∞</a> -->
              <a href="{% url 'supplier_form' supplier.id %}" class="btn btn-primary btn-sm copy-link"
                data-supplier-id="{{ supplier.id }}">üìã –î–ª—è –ø–æ—Å—Ç–∞–≤—â–∏–∫–∞</a>
            </td>
          </tr>
          {% endfor %}
        </tbody>
      </table>
    </div>
  </div>

  {% include 'footer.html' %}

  <script>
    document.querySelectorAll('.copy-link').forEach(button => {
      button.addEventListener('click', function (event) {
        event.preventDefault();
        let supplierId = this.getAttribute('data-supplier-id');

        fetch(`/get_supplier_token/${supplierId}/`)
          .then(response => response.json())
          .then(data => {
            navigator.clipboard.writeText(data.url).then(() => {
              alert("–°—Å—ã–ª–∫–∞ —Å–∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∞ –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞!");
            }).catch(err => {
              console.error("–û—à–∏–±–∫–∞ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏—è: ", err);
            });
          })
          .catch(error => console.error("–û—à–∏–±–∫–∞ –∑–∞–ø—Ä–æ—Å–∞:", error));
      });
    });
  </script>

<script src="{% static 'js/bootstrap.bundle.min.js' %}"></script>

</body>

</html>